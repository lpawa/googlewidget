<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="composeEvent Test" height="80" author="lakshya" author_email="lakshyapawa@google.com">
<Require feature="google.calendar-0.5"/>
<Require feature="google.calendar-0.5.read"/>
</ModulePrefs>
<Content type="html">
<![CDATA[
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
<html>
<body>
<script> function compose() 
{ 
var eventData = { 
title: 'Christmas', 
details: 'Merry Christmas to you!', 
location: 'My house', 
allDay: true, 
startTime: {year: 2017, month: 12, date: 25},
endTime: {year: 2017, month: 12, date: 26},
attendees: [ {email: 'davem.gadgets@gmail.com'} ]
}
google.calendar.composeEvent(eventData);

function preferencesCallback(prefs) {
  var out = '';
  if ('startdow' in prefs) {
    out += "Day of week = " + prefs.startdow + "\n";
  }
  if ('military' in prefs) {
    out += "Military time = " + prefs.military + "\n";
  }
  out+= "Viewer = " + prefs.viewer + "\n";
  alert(out);
}

// Ask the calendar for the preferences
google.calendar.getPreferences(preferencesCallback);



console.log("Start");
function subscribeEventsCallback(e) {
  console.log("Start Callback");
  var html = 'No event';
  if (e) {
    html = gadgets.json.stringify(e);
  }
  document.getElementById('out').innerHTML = gadgets.util.escapeString(html);
}


gadgets.util.registerOnLoadHandler(function() {
  console.log("Event trying to be called");
  google.calendar.read.subscribeToEvents(subscribeEventsCallback);
  console.log("Event should have been called");
});

}
 </script> 
<center> <button onclick="compose()">Compose Event</button> 
<div id="out">No event</div>
</center> 
</body>
</html>
]]>
</Content>
</Module>


